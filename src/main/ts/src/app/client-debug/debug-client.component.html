<mat-card class="init-game-card" style="margin-top: 5px">
  <!--websocket connection-->
  <button mat-raised-button color="accent" (click)="connect()">Connect to Server</button>
  <!--view the game state-->
  <button mat-raised-button class="mat-elevation-z2" (click)="logGameState()" style="float: right">
    Log Game State
  </button>

  <!--join game-->
  <div *ngIf="isConnected()" style="margin-top: 20px">
    <form>
      <mat-form-field color="accent" style="margin-right: 10px">
        <mat-label>Player ID</mat-label>
        <input matInput type="text" [disabled]="gameService.gameState" [(ngModel)]="gameService.playerId"
               [ngModelOptions]="{standalone: true}">
      </mat-form-field>
      <button mat-raised-button color="accent" [disabled]="joinClicked || gameService.playerId == null"
              [matMenuTriggerFor]="playModes">Quick Play Modes
      </button>
      <mat-menu #playModes="matMenu">
        <button mat-menu-item (click)="joinGame('1vCom')">Join 1vCom Game</button>
        <button mat-menu-item (click)="joinGame('4ffaCom')">Join 4ffaCom Game</button>
        <button mat-menu-item (click)="joinGame('1v1')">Join 1v1 Game</button>
        <button mat-menu-item (click)="joinGame('4ffa')">Join 4ffa Game</button>
      </mat-menu>
    </form>
  </div>

</mat-card>

<div *ngIf="gameService.gameState" cdkDropListGroup>
  <div fxLayout="row wrap" fxLayoutGap="5px grid">
    <app-character-card fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%"
                        [isPlayer]="true"
                        [playerState]="gameService.playerState"
                        id="self"
                        cdkDropList (cdkDropListDropped)="playDraggedCard($event)">
    </app-character-card>
    <!--TODO OK hear me out, I'm not gone mad-->
    <!--ngFor somehow messes with cdkDropList and I figured out I can't dynamically generate this with it-->
    <!--luckily I have either 1 or 3 opponents, so with this heresy I can get away and have my dear d&d-->
    <app-character-card fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%"
                        [isPlayer]="false"
                        [playerState]="gameService.opponents[0]"
                        id="{{gameService.opponents[0].playerId}}"
                        cdkDropList (cdkDropListDropped)="playDraggedCard($event)">
    </app-character-card>
    <app-character-card fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%" *ngIf="gameService.opponents.length >= 2"
                        [isPlayer]="false"
                        [playerState]="gameService.opponents[1]"
                        id="{{gameService.opponents[1].playerId}}"
                        cdkDropList (cdkDropListDropped)="playDraggedCard($event)">
    </app-character-card>
    <app-character-card fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%" *ngIf="gameService.opponents.length >= 3"
                        [isPlayer]="false"
                        [playerState]="gameService.opponents[2]"
                        id="{{gameService.opponents[2].playerId}}"
                        cdkDropList (cdkDropListDropped)="playDraggedCard($event)">
      <!--no placeholder-->
      <div *cdkDragPlaceholder></div>
    </app-character-card>
  </div>

  <br>

  <div>
    <app-card-in-hand *ngFor="let card of gameService.cardsInHand"
                      id="{{card.name}}"
                      cdkDropList cdkDrag></app-card-in-hand>
  </div>

</div>

<br>
<!--choose your move-->
<label *ngIf="gameService.cardsInHand">
  Target Opponent
  <select [(ngModel)]="selectedTargetOpponent">
    <option *ngFor="let opponent of gameService.opponents" [value]="opponent.playerId" ngDefaultControl>
      {{opponent.playerId}}
    </option>
  </select>
</label>
<div *ngFor="let card of gameService.cardsInHand" style="margin-bottom: 5px;">
  {{card.name}}
  <button (click)="playCard(card.name)">Play This</button>
  <br>
  cost:{{card.cost | json}}
  <br>
  effect:{{card.effect}}
  <br>
  ----------------------------------------------------------------
</div>
